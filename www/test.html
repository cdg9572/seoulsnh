<?php

include "./PHPExcel/PHPExcel.php";

// 새로운 Excel 객체를 생성합니다.
$objPHPExcel = new PHPExcel();

$arrTwice = array();
$arrTwice[1] = array("name" => "나연", "position" => "리드보컬, 리드댄서", "birthday" => "09월 22일");
$arrTwice[2] = array("name" => "정연", "position" => "리드보컬", "birthday" => "11월 01일");
$arrTwice[3] = array("name" => "모모", "position" => "서브보컬, 메인댄서, 서브래퍼", "birthday" => "11월 09일");
$arrTwice[4] = array("name" => "사나", "position" => "서브보컬", "birthday" => "12월 29일");
$arrTwice[5] = array("name" => "지효", "position" => "리더, 메인보컬", "birthday" => "02월 01일");
$arrTwice[6] = array("name" => "미나", "position" => "서브보컬, 메인댄서, 서브래퍼", "birthday" => "03월 24일");
$arrTwice[7] = array("name" => "다현", "position" => "리드래퍼, 서브보컬", "birthday" => "05월 28일");
$arrTwice[8] = array("name" => "채영", "position" => "메인래퍼, 서브보컬", "birthday" => "04월 23일");
$arrTwice[9] = array("name" => "쯔위", "position" => "서브보컬, 리드댄서", "birthday" => "06월 14일");

$objPHPExcel -> setActiveSheetIndex(0)
-> setCellValue("A1", "NO.")
-> setCellValue("B1", "이름")
-> setCellValue("C1", "포지션")
-> setCellValue("D1", "생일");

$count = 1;
foreach($arrTwice as $key => $val) {
	$num = 1 + $key;
	$objPHPExcel -> setActiveSheetIndex(0)
	-> setCellValue(sprintf("A%s", $num), $key)
	-> setCellValue(sprintf("B%s", $num), $val['name'])
	-> setCellValueExplicit(sprintf("C%s", $num), $val['position'])
	-> setCellValue(sprintf("D%s", $num), $val['birthday']);
	$count++;
}

// 시트 제목을 설정합니다.
$objPHPExcel->getActiveSheet()->setTitle('My Sheet');

// 첫번째 시트(Sheet)로 열리게 설정
$objPHPExcel -> setActiveSheetIndex(0);


// 파일의 저장형식이 utf-8일 경우 한글파일 이름은 깨지므로 euc-kr로 변환해준다.
$filename = iconv("UTF-8", "EUC-KR", "트와이스_TWICE");


// 브라우저로 엑셀파일을 리다이렉션
// header("Content-Type:application/vnd.ms-excel");
header("Content-Disposition: attachment;filename=".$filename.".xls");
// header("Cache-Control:max-age=0");


$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, "Excel5");

$objWriter -> save("php://output");

echo 'Excel 파일이 생성되었습니다.';

?>